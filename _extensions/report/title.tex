% Placement of logos

\RequirePackage[absolute,overlay]{textpos}
\setlength{\TPHorizModule}{1cm}
\setlength{\TPVertModule}{1cm}
\def\placefig#1#2#3#4{\begin{textblock}{.1}(#1,#2)\rlap{\includegraphics[#3]{#4}}\end{textblock}}

% Title and date

$if(title)$
\title{$title$}
$endif$
$if(subtitle)$
\usepackage{etoolbox}
\makeatletter
\providecommand{\subtitle}[1]{% add subtitle to \maketitle
  \apptocmd{\@title}{\par {\large #1 \par}}{}{}
}
\makeatother
\subtitle{$subtitle$}
$endif$
\date{$date$}

\def\Date{\number\day}
\def\Month{\ifcase\month\or
 January\or February\or March\or April\or May\or June\or
 July\or August\or September\or October\or November\or December\fi}
\def\Year{\number\year}

%%%% PAGE STYLE FOR FRONT PAGE OF REPORTS

\makeatletter
\def\organization#1{\gdef\@organization{#1}}
\def\telephone#1{\gdef\@telephone{#1}}
\def\email#1{\gdef\@email{#1}}
\makeatother
$if(organization)$
  \organization{$organization$}
$else$
  \organization{}
$endif$

$if(department)$
  \def\name{$department$}
$else$
  \def\name{}
$endif$

$if(phone)$
  \telephone{$phone$}
$else$
  \telephone{}
$endif$

$if(email)$
  \email{$email$}
$else$
  \email{}
$endif$

$if(reportnumber)$
  \def\reportnumber{$reportnumber$}
$else$
  \def\reportnumber{Please provide a report number in the metadata}
$endif$

\def\webaddress{\url{https://www.etsmtl.ca}}
\def\extraspace{\vspace*{1.6cm}}
\makeatletter
\def\contactdetails{Service de la bibliothèque\\
École de technologie supérieure\\
1100, rue Notre-Dame Ouest\\
Montréal (Québec)\\
H3C 1K3\\
\\
Phone: +1 514 396-8946\\
Fax: +1 514 396-8633\\
Email: \href{mailto:biblio@etsmtl.ca}{biblio@etsmtl.ca}
}
\makeatother

\usepackage[absolute,overlay]{textpos}
\setlength{\TPHorizModule}{1cm}
\setlength{\TPVertModule}{1cm}

%%%% FRONT PAGE OF REPORTS

\def\reporttype{Technical Report}

\long\def\front#1#2#3{
\newpage
\begin{singlespacing}
\thispagestyle{empty}
\vspace*{-1.4cm}
\hspace*{-1.4cm}
\hbox to 16cm{
  \hbox to 6.5cm{\vbox to 14cm{\vbox to 22cm{
    \includegraphics[width=6cm]{Logo_ETS_TypoGrise_D_FR_1}
    \vfill
    % \includegraphics[width=2cm]{MBSportrait}
    % \vspace{0.4cm}
    % \par
    \parbox{3.3cm}{\raggedright
      \sf\color[rgb]{0.00,0.00,0.70}
      {\large\textbf{\name}}\par
      % \vspace{.7cm}
      \tabcolsep=0.12cm\sf\small
      \begin{tabular}{@{}ll@{}}\contactdetails
      \end{tabular}
      \vspace*{0.1cm}\par
      % ABN: \abn\par
    }
  }\vss}\hss}
  \hspace*{0.2cm}
  \hbox to 1cm{\vbox to 14cm{\rule{1pt}{24cm}\vss}\hss\hfill}
  \hbox to 10cm{\vbox to 14cm{\vbox to 23cm{

      \begin{textblock*}{10cm}(9cm,2cm)
        \raggedleft
        \large\sf\textbf{ETS-RT - \reportnumber}
      \end{textblock*}

      \vspace*{5cm}\sf\raggedright
      \parbox{10cm}{\sf\raggedright\baselineskip=1.2cm
         \fontsize{24.88}{30}\color[rgb]{0.70,0.00,0.00}\sf\textbf{#1}} % Title
      \par
      \vfill
      \large
      \vbox{\parskip=0.8cm #2}\par % Authors
      % \vspace*{2cm}\par
      \vfill
      \reporttype\\[0.3cm]
      \hbox{#3}%\\[2cm]\ \par % Organization
      \vspace*{1cm}
      {\large\sf\textbf{\Date~\Month~\Year}}
   }\vss}
  }}
\end{singlespacing}
\newpage
}

\makeatletter
\def\maketitle{\front{\expandafter{\@title}}{\@author}{\@organization}}
\makeatother

% Authors

\author{\sf$for(by-author)${\Large\textbf{$by-author.name.literal$} $if(by-author.degrees)$\\\large $by-author.degrees$$endif$\\[0.5cm]}$endfor$}
\lfoot{\sf $for(by-author)$$by-author.name.family$$sep$, $endfor$: $date$}
